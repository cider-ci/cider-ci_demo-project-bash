name: Submodule demos and tests

task_defaults:
  eager_trials: 1
  auto_trials: 2

  traits:
    linux: true

  git_options: 
    submodules: 
      clone: True 
      timeout: 30
    

tasks: 

  submodule-file: 
    name: Verify that file in submodule does exist
    scripts: 
      main: 
        body: test -f submodule/README.mkd

  submodule-ls:
    name: List submodule directory
    scripts: 
      main: 
        body: 
          ls -lah submodule 

  submodule-commit:
    name: Verify proper commit in submodule directory 
    scripts: 
      main: 
        body: cd submodule && test $(git log -n 1 --pretty='%H') == c23181dfdeeb767b3445b690e9c9067d9ab6c714

  without-submodule-file: 
    name: Verify that file in submodule does not exist if clone is False
    git_options: 
      submodules: 
        clone: False
    scripts: 
      main: 
        body: test ! -f submodule/README.mkd


